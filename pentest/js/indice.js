$(document).ready(function() {
    var API_URL = "https://907eai98a5.execute-api.us-east-1.amazonaws.com/default/indice";
    if (cognitoUser != null) {
        cognitoUser.getSession(function(err, session) {
            if (err) {
                console.log(err.message || JSON.stringify(err));
                window.location.href = "../index.html";
                return;
            }
            else {
              $.ajax({
                type: 'GET',
                url: API_URL,
                beforeSend: function(xhr){xhr.setRequestHeader('Authorization', session.getIdToken().getJwtToken());},
                success: function (data){
                  jsonFormat = JSON.parse(data.body);
                  $('#titulo').html(jsonFormat.Titulo);
                  jsonFormat.Modulo.forEach(function fillModules(item,i){
                  $('#moduleContainer').html(
                    "<a href='./introduccion.html'  class='list-group-item list-group-item-action flex-column align-items-start active'><div class='d-flex w-100 justify-content-between'><h5 class='mb-1' id='modulo1'>"+
                      item.Modulo+"</h5><small id='fechaModulo1'>"+item.FechaModulo+"</small></div><p class='mb-1' id='descripcionModulo1'>"+
                      item.DescripcionModulo+"</p><small id='examenModulo1'>"+item.ExamenModulo+"</small></a>"
                    );
                    displayUser = cognitoUser.username.split("@")[0];
                    $("#finalUser").html(displayUser);
                  });
                },
                error: function(data){
                  window.location.href = "../index.html";
                },
              });
              return false;
            }
        });
    }
});
